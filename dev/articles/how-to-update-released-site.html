<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to update a released site • pkgdown</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to update a released site">
<meta name="description" content='A guide to updating the "released" version of your pkgdown site without having to release a new version of your package.
'>
<meta property="og:description" content='A guide to updating the "released" version of your pkgdown site without having to release a new version of your package.
'>
<meta property="og:image" content="https://pkgdown.r-lib.org/logo.png">
<meta name="robots" content="noindex">
<script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pkgdown</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.1.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/pkgdown.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/customise.html">Customise your site</a></li>
    <li><a class="dropdown-item" href="../articles/quarto.html">quarto vignettes</a></li>
    <li><a class="dropdown-item" href="../articles/translations.html">Translations</a></li>
    <li><a class="dropdown-item" href="../articles/accessibility.html">Accessibility</a></li>
    <li><a class="dropdown-item" href="../articles/linking.html">Auto-linking</a></li>
    <li><a class="dropdown-item" href="../articles/metadata.html">Metadata</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/07/pkgdown-2-1-0/">Version 2.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/12/pkgdown-2-0-0/">Version 2.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/09/pkgdown-1-6-0/">Version 1.6.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/03/pkgdown-1-5-0/">Version 1.5.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/09/pkgdown-1-4-0/">Version 1.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/12/pkgdown-1-3-0/">Version 1.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/06/pkgdown-1-1-0/">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/05/pkgdown-1-0-0/">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/pkgdown/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How to update a released site</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/pkgdown/blob/main/vignettes/how-to-update-released-site.Rmd" class="external-link"><code>vignettes/how-to-update-released-site.Rmd</code></a></small>
      <div class="d-none name"><code>how-to-update-released-site.Rmd</code></div>
    </div>

    
    
<p>This vignette shows you how to update the released version of your
site to match the dev version of the site, so the first step is to
ensure that the dev site looks the way that you want it.</p>
<p>This site assumes that you’re using a recent version of our
recommended <a href="https://github.com/r-lib/actions/blob/HEAD/examples/pkgdown.yaml" class="external-link">pkgdown
action</a>. If your workflow does not contain
<code>workflow_dispatch</code>, you will need to update
<code>.github/actions/pkgdown.yaml</code> by running
<code>use_github_action("pkgdown")</code>.</p>
<div class="section level2">
<h2 id="process">Process<a class="anchor" aria-label="anchor" href="#process"></a>
</h2>
<p>If you’re up to speed with the basic idea and just want some code to
follow, here it is. Otherwise, read more below.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>First, make sure you’re in the <code>main</code> branch, and you have
the latest version:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_branch.html" class="external-link">git_branch_checkout</a></span><span class="op">(</span><span class="st">"main"</span><span class="op">)</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_fetch.html" class="external-link">git_pull</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next figure out the released version that you’re updating:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ver</span> <span class="op">&lt;-</span> <span class="fu">desc</span><span class="fu">::</span><span class="fu"><a href="https://desc.r-lib.org/reference/desc_get_version.html" class="external-link">desc_get_version</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<p>You will use this to create and checkout the branch that you’ll work
in:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_branch.html" class="external-link">git_branch_create</a></span><span class="op">(</span></span>
<span>  branch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pkgdown-v"</span>, <span class="va">ver</span><span class="op">)</span>,</span>
<span>  ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"v"</span>, <span class="va">ver</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This assumes that the <code>ver</code> version of your package,
e.g. version X.Y.Z, has been marked with the the git tag ‘vX.Y.Z’. This
happens automatically if you use
<code><a href="https://usethis.r-lib.org/reference/use_github_release.html" class="external-link">usethis::use_github_release()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="backport-changes">Backport changes<a class="anchor" aria-label="anchor" href="#backport-changes"></a>
</h3>
<p>Now you need to backport changes from the dev site into this branch.
Run this R code to generate the git code to pull changes for the most
common locations:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="co"># overall site config</span></span>
<span>  <span class="st">"_pkgdown.yml"</span>,</span>
<span>  <span class="co"># the workflow that builds the site</span></span>
<span>  <span class="st">".github/workflows/pkgdown.yaml"</span>,</span>
<span>  <span class="co"># readme and vignettes</span></span>
<span>  <span class="st">"README.md"</span>, <span class="st">"vignettes"</span>,</span>
<span>  <span class="co"># logo and favicon</span></span>
<span>  <span class="st">"man/figures/"</span>, <span class="st">"pkgdown/"</span>,</span>
<span>  <span class="co"># Author metadata and Config/Needs/Website</span></span>
<span>  <span class="st">"DESCRIPTION"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"git checkout main -- {files}"</span><span class="op">)</span></span></code></pre></div>
<p>If you backport <code>DESCRIPTION</code>, you’ll also need undo the
change to the <code>Version</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">desc</span><span class="fu">::</span><span class="fu"><a href="https://desc.r-lib.org/reference/desc_set_version.html" class="external-link">desc_set_version</a></span><span class="op">(</span><span class="va">ver</span><span class="op">)</span></span></code></pre></div>
<p>Now build the site locally and check that it looks as expected:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="../reference/build_site.html">build_site</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Make sure to commit these changes.</p>
</div>
<div class="section level3">
<h3 id="publish">Publish<a class="anchor" aria-label="anchor" href="#publish"></a>
</h3>
<p>Now you need to publish the site. First push your branch to
GitHub:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">:::</span><span class="fu">git_push_first</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Then trigger the pkgdown workflow:</p>
<ol style="list-style-type: decimal">
<li>Go to your package’s GHA page, e.g. with
<code><a href="https://usethis.r-lib.org/reference/browse-this.html" class="external-link">usethis::browse_github_actions()</a></code>.</li>
<li>Select the pkgdown workflow.</li>
<li>Click <em>Run workflow</em> and select the branch you just
pushed.</li>
</ol>
<p>If there’s no dropdown menu for this, that means your pkgdown
workflow config is not current.</p>
</div>
</div>
<div class="section level2">
<h2 id="context">Context<a class="anchor" aria-label="anchor" href="#context"></a>
</h2>
<p>Now that we’ve sketched <strong>how</strong> to update a released
site, we discuss <strong>why</strong> you might need to do this. What is
a released site? What other kind of pkgdown site could you have? Why
does updating a released site take special effort?</p>
<div class="section level3">
<h3 id="automatic-development-mode">Automatic development mode<a class="anchor" aria-label="anchor" href="#automatic-development-mode"></a>
</h3>
<p>Every pkgdown site has a so-called <a href="https://pkgdown.r-lib.org/reference/build_site.html#development-mode"><em>development
mode</em></a>, which can be specified via the <code>development</code>
field in <code>_pkgdown.yml</code>. If unspecified, the default is
<code>mode: release</code>, which results in a single pkgdown site.
Despite the name, this single site reflects “the current package state”,
which could be either a released state or a development state.</p>
<p>For packages with a substantial user base, it is recommended instead
to specify <code>mode: auto</code> like so:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">development</span><span class="kw">:</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mode</span><span class="kw">:</span><span class="at"> auto</span></span></code></pre></div>
<p>This directs pkgdown to “generate different sites for the development
and released versions of your package.”</p>
<p>The readr package demonstrates what happens in automatic development
mode:</p>
<p><a href="https://readr.tidyverse.org" class="external-link">readr.tidyverse.org</a>
documents the released version, i.e. what
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> will deliver.<br><a href="https://readr.tidyverse.org/dev/" class="external-link">readr.tidyverse.org/dev/</a>
documents the dev version, i.e. what you’d get by installing from
GitHub.</p>
<p>In this mode, <code><a href="../reference/build_site.html">pkgdown::build_site()</a></code>, consults
DESCRIPTION to learn the package’s version number. For a development
version number, the rendered site is written to <code>docs/dev/</code>.
For a released version number, the site is written to
<code>docs/</code>. (There are also other signals to alert users that
they are reading documentation for a dev version vs. a released
version.)</p>
<p>Automatic development mode is recommended for packages with a broad
user base because it maximizes the chance that a user will read
web-based documentation which reflects the package version that is
locally installed.</p>
</div>
<div class="section level3">
<h3 id="publishing">Publishing<a class="anchor" aria-label="anchor" href="#publishing"></a>
</h3>
<p>Now that we’ve established the meaning of a released (vs dev) site,
we have to consider how the site is built (i.e. how the HTML is
generated) and deployed (i.e. how the HTML is published to a website so
people can see it.).</p>
<p>We recommend <code><a href="https://usethis.r-lib.org/reference/use_pkgdown.html" class="external-link">usethis::use_pkgdown_github_pages()</a></code> to do
basic pkgdown setup and configure a GitHub Actions (GHA) workflow to
automatically render and publish the site to GitHub Pages. This function
is basically a shortcut for calling the following functions
individually:</p>
<ul>
<li><code>use_pkgdown()</code></li>
<li><code>use_github_pages()</code></li>
<li><code>use_github_action("pkgdown")</code></li>
</ul>
<p>It then adds the pkgdown site’s URL to <code>_pkgdown.yml</code>, the
<code>URL</code> field of DESCRIPTION, and the GitHub repo.</p>
<p>As a result, the publishing cadence of many pkgdown sites is governed
by the workflow maintained at <a href="https://github.com/r-lib/actions/blob/v2/examples/pkgdown.yaml" class="external-link"><code>r-lib/actions/examples/pkgdown.yaml</code></a>.
(Do not confuse <code>_pkgdown.yml</code>, which gives instructions to
the pkgdown package, with <code>.github/workflows/pkgdown.yaml</code>,
which gives instructions to GHA.)</p>
<p>Here are some of the most important bits of the GHA workflow
config:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">,</span><span class="at"> master</span><span class="kw">]</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">,</span><span class="at"> master</span><span class="kw">]</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="at">  </span><span class="fu">release</span><span class="kw">:</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="at">    </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">published</span><span class="kw">]</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="at">&lt;snip, snip&gt;</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Build site</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> Rscript -e 'pkgdown::build_site_github_pages(...)'</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Deploy to GitHub pages 🚀</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="at">        </span><span class="fu">if</span><span class="kw">:</span><span class="at"> github.event_name != 'pull_request'</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> JamesIves/github-pages-deploy-action@4.1.4</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="at">        &lt;snip, snip&gt;</span></span></code></pre></div>
<p>Altogether this means that we:</p>
<ul>
<li><p>Build and deploy for pushes to <code>main</code>.</p></li>
<li><p>Build, but don’t deploy, for pull requests against
<code>main</code>. This reveals any pkgdown errors, but ensures the live
site isn’t updated until the pull request is merged (because the code is
pushed to <code>main</code>).</p></li>
<li><p>Build and deploy when we publish a GitHub release. By convention,
we assume that a GitHub release coincides with a CRAN release. So this
is the <strong>primary mechanism for building the released pkgdown
site</strong>.</p></li>
</ul>
<p><code><a href="../reference/build_site_github_pages.html">pkgdown::build_site_github_pages()</a></code> consults the version
in DESCRIPTION to detect whether it’s building from a released version
or a dev version. That determines the <code>dest_dir</code>,
e.g. <code>docs/</code> for released and <code>docs/dev/</code> for dev.
For a package in automatic development mode, this means that almost all
of your pushes trigger an update to the dev site. The released site is
only updated when you push a state with a non-development version number
or when you publish a GitHub release.</p>
<p>So how do you tweak things about the released site <em>in
between</em> releases?</p>
<p>That brings us to <code>workflow_dispatch:</code>. (Yes that dangling
colon is correct.)</p>
<p>The inclusion of <code>workflow_dispatch</code> as a trigger means
the pkgdown workflow can be <a href="https://docs.github.com/en/actions/using-workflows/manually-running-a-workflow" class="external-link">run
on demand</a>, most importantly from the browser.</p>
</div>
</div>
<div class="section level2">
<h2 id="construct-a-branch-for-the-update">Construct a branch for the update<a class="anchor" aria-label="anchor" href="#construct-a-branch-for-the-update"></a>
</h2>
<p>The overall goal is to create a branch that combines some features of
the released website (e.g. the released version) and the development
version (e.g. improvements to your <code>_pkgdown.yml</code>). The
easiest way is to start your branch using the latest release tag, then
bring in selected changes or files from the development version.</p>
<p>For example, if readr’s latest release is 2.1.1:</p>
<pre><code>git checkout -b update-pkgdown-2-1-1 v2.1.1</code></pre>
<p>And here is the general pattern:</p>
<pre><code>git checkout -b NEW-BRANCH-NAME NAME-OF-RELEASE-TAG</code></pre>
<p>Now you should port innovations from the development site that you
want to apply to your released site.</p>
<p>Files you must update:</p>
<ul>
<li><code>.github/workflows/pkgdown.yaml</code></li>
<li><code>_pkgdown.yml</code></li>
<li>
<code>Config/Needs/website</code> field of DESCRIPTION (And,
probably, only this field! In particular, do not mess with the version
number.)</li>
</ul>
<p>Other likely candidates:</p>
<ul>
<li>
<code>README.Rmd</code> + <code>README.md</code>, e.g., if you’ve
updated badges.</li>
<li>Any documentation fixes that <strong>apply to the released
version</strong>. This is the only reason to touch anything below
<code>R/</code> and even then it should only affect roxygen comments.
Don’t forget to <code>document()</code> if you do this!</li>
<li>Any new vignettes or articles that apply to the released
version.</li>
</ul>
<p>Here are some tips on backporting specific changes into this branch.
If you are lucky, there are specific commits in your default branch that
contain all the necessary changes. In that case, we can cherry pick such
a commit by its SHA:</p>
<pre><code>git cherry-pick SHA</code></pre>
<p>If that doesn’t cover everything for each file you want to update,
identify a Git reference (meaning: a SHA, tag, or branch) where the file
is in the desired state. Checkout that specific file path from that
specific ref:</p>
<pre><code>git checkout main -- path/to/the/file</code></pre>
<p>For example, readr recently gained a new vignette that applies to the
released version of readr, i.e. it does not document any dev-only
features or functions. We can bring that into the current branch
with:</p>
<pre><code>git checkout main -- vignettes/column-types.Rmd</code></pre>
<p>Commit and push this new branch to GitHub.
<code><a href="https://usethis.r-lib.org/reference/pull-requests.html" class="external-link">usethis::pr_push()</a></code> can be handy for this. Just don’t bother
opening a pull request (the branch will still be pushed).</p>
<p>Now we will use the <code>workflow_dispatch</code> GHA trigger:</p>
<ol style="list-style-type: decimal">
<li>Go to the Actions page of your repo, maybe via
<code><a href="https://usethis.r-lib.org/reference/browse-this.html" class="external-link">usethis::browse_github_actions()</a></code>.</li>
<li>Click on the <code>pkgdown</code> workflow.</li>
<li>Click the “Run workflow”.</li>
<li>In the “Use workflow from” dropdown menu, select the branch you’ve
just made and pushed, then click “Run workflow”.</li>
</ol>
<p>This should kick off a pkgdown build-and-deploy and, specifically, it
should cause updates to the <strong>released</strong> site.</p>
<p>You can keep this branch around for a while, in case you didn’t get
everything right the first time or if more things crop up that you’d
like backport to the released site, before your next CRAN release.</p>
</div>
<div class="section level2">
<h2 id="problem-solving">Problem-solving<a class="anchor" aria-label="anchor" href="#problem-solving"></a>
</h2>
<p>Another great problem solving technique is to get a bunch of other
people’s <code>_pkgdown.yml</code> files in front of your eyeballs.
There are two ways to do this: <a href="https://github.com/search?q=path%3A%22_pkgdown.yml%22+AND+%28org%3Atidyverse+OR+org%3Ar-lib%29&amp;type=code" class="external-link">GitHub
search</a> or <a href="https://github.com/MichaelChirico/r-ci-samples/tree/master/pkgdown" class="external-link">Michael
Chirico’s <code>r-ci-samples</code> repo</a>. For any given
<code>_pkgdown.yml</code> file, remember that its History and Blame can
be helpful for seeing how it has evolved over time.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://hesselberthlab.org" class="external-link">Jay Hesselberth</a>, <a href="https://masalmon.eu" class="external-link">Maëlle Salmon</a>, Olivier Roy, <a href="https://salim.space" class="external-link">Salim Brüggemann</a>, <a href="https://posit.co" class="external-link">Posit Software, PBC</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
